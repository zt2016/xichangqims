<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:f="http://java.sun.com/jsf/core" 
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:h="http://java.sun.com/jsf/html">
<h:head>
</h:head>
<h:body>
<f:view>
	<p:layout fullPage="true">
	
	    <p:layoutUnit position="center">
	    
	    	<h:panelGrid columns="1" width="100%" id="toolbar">
	    		<p:commandButton value="Create" type="button" onclick="PF('dlg1').show();" />
	    	</h:panelGrid>
	    	
	    	<h:panelGrid columns="1" width="100%" id="dataGrid1">
				<p:dataTable value="#{lazyTaskListManagedBean.taskBaseLazyDataModel}" 
							 var="selected" 
							 lazy="true"
							 selectionMode="single" 
							 selection="#{lazyTaskListManagedBean.selected}"
							 rows="5"
                         	 paginator="true"
                         	 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         	 rowsPerPageTemplate="5,10,15" 
                         	 sortBy="name">
					<p:ajax event="rowSelect" listener="#{lazyTaskListManagedBean.onRowSelect}" update="messages" />
					<p:column headerText="ID">
						<h:outputLink value="http://localhost:8080/qmis/faces/task_details.xhtml?id=#{taskBase.id}" 
									  title="Click to access task details">
							<h:outputText value="#{selected.id}" />
						</h:outputLink>
					</p:column>
					<p:column headerText="Task Name">
						<h:outputText value="#{selected.name}" />
					</p:column>
					<p:column headerText="Category">
						<h:outputText value="#{selected.category}" />
					</p:column>
					<p:column headerText="Start Time">
						<h:outputText value="#{selected.startTime}" />
					</p:column>
					<p:column headerText="End Time">
						<h:outputText value="#{selected.endTime}" />
					</p:column>
				</p:dataTable>
			</h:panelGrid>
	    </p:layoutUnit>
	
	</p:layout>	

	<p:dialog header="Create New Task" widgetVar="dlg1" modal="true" height="400" width="600" >
		<h:form prependId="false">
		    <h:panelGrid columns="2" columnClasses="label, value" style="margin-bottom:10px" cellpadding="5" id="createNewTask">
		    	<h:outputLabel value="Name:" />
		    	<h:inputText value="#{lazyTaskListManagedBean.taskBase.name}" />
		    	<h:outputLabel value="Category:" rendered="true" />
		    	<p:selectOneListbox id="selectCategory1" value="#{lazyTaskListManagedBean.taskBase.category}" rendered="true">
					<f:selectItems value="#{taskCategoryManagedBean.taskCategoryList}" var="taskCategory" itemLabel="#{taskCategory.name}" itemValue="#{taskCategory.id}">
					</f:selectItems>
		        </p:selectOneListbox>
		    	<h:outputLabel value="Start Time:" />
		    	<p:calendar id="newTaskStartTime" value="#{lazyTaskListManagedBean.taskBase.startTime}" pattern="MM/dd/yyyy HH:mm:ss" />
		    	<h:outputLabel value="End Time:" />
		    	<p:calendar id="newTaskEndTime" value="#{lazyTaskListManagedBean.taskBase.endTime}" pattern="MM/dd/yyyy HH:mm:ss" />
		    </h:panelGrid>
		    <p:commandButton value="Submit" update="messages" action="#{lazyTaskListManagedBean.createTask}"  ajax="false" icon="ui-icon-check" />
	    </h:form>
	</p:dialog>
	
	<p:growl id="messages" showDetail="true"/>
	
</f:view>
</h:body>
</html>